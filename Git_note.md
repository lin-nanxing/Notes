# Git 笔记记录(个人向)
---
# 1.Git简介
- 免费开源
  
- 分布式版本控制系统
  
- 使用名叫仓库`repository`的数据库来记录文件的变化，仓库中每个文件都有一个完整的**版本历史纪录**，以方便查看谁在什么时间修改了哪些文件的什么内容。**它还支持将文件恢复到之前的某个版本**  
    
- 它大大方便团队间对同一项目的合作，使得项目更改便捷清晰有效。
>与分布式控制系统相较，还存在一类集中式版本控制系统，如`SVN`、`CVS`等。

- 什么是分布式，**每个人手里都有副本**，凭借着一定的信用协议进行信息的交换那就是分布式。    
  Git就是每个人设备里都有完整的库的分布式。完成成员间信息的交换，互相同步一下就可以了。 
---
- *世界上超过90%的开源项目都在使用Git进行版本控制，足可见它的强大*

# 2.Git的使用方式   
- 命令行(Shell或者是cmd)
- 图形化界面(GUI)
  >在Git官网就能找到诸如Git Cilents
- IDE插件或拓展(Git Bash)

# 3.Git的工作区域与文件状态
- Git的区域分为**工作区**`working directory`、**暂存区**`staging area/index`以及**本地仓库**`local repository`。
- 1. *工作区*
  - 又叫`工作目录`或者`本地工作目录`，也就是我们自己电脑的目录(文件夹)。 
  
  2. *暂存区*
  - 又叫`索引`即`index`，是一种临时存储区域，用于保存即将提交到Git仓库的修改内容。

  3. *本地仓库*
  - 就是通过`init`或者`clone`生成的仓库，**包含完整的项目历史和元数据**，是Git存储代码和版本信息的主要位置。
- 三者之间的关系类似于a端、b端、c端或者是寄存器、Cache、主存之间的关系。其中工作区提交到暂存区通过`git add`命令，暂存区提交到本地仓库通过`git commit`命令，两者的结合被称为**提交**。
- 在Git中，文件存在四种形式：**未跟踪**`Untrack`、**未修改**`Unmodified`、**已修改**`Modified`和**已暂存**`Staged`。
  1. 未跟踪
     > 新创建的未被Git管理起来的文件
  2. 未修改    
     > 已经被Git管理起来的但还没被修改过的文件
  3. 已修改 
     > 被Git管理起来且已被修改的文件
  4. 已暂存    
     > 已经提交到暂存区`index`的文件

   具体说明如下图：  
   ![文件流程](/jpg/屏幕截图%202024-01-25%20172204.png)

# 4.常用的Git命令
1. `git config --global user.name "用户名"`
   \* 初始化的时候设置用户名 
2. `git config --global user.mail 邮箱地址`
   \* 初始化的时候设置邮箱地址

> - 不写或者写作`--local`是本地配置的意思，只对本地仓库有用；`--global`是全局配置，对所有仓库都生效；`--system`是系统配置，对所有用户都生效。 
>
> - 若用户名中没有空格，不用双引号也是可以的

3. `git config --global credential.helper store`
   \*保存用户名和密码，这样就不用每次都输入了

4. `git config --global --list`
   \*查看git的配置信息  

5. **创建仓库**
   >创建仓库有两种办法，第一种是初始化一个空白库，第二种是从他处克隆一个现成的仓库。
   1. *init*
    首先创建一个文件夹(目录)，后边创建的库在该目录下运行。创建可以用**命令行语句**`mkdir 目录名`，之后用`cd 目录名`打开以方便在目录底下进行。
    随后使用`git init`创建库，默认的初始库名字叫`main`即主干(类似于树。即表示当前分支的名称，分支是当前演化的位置)。 
    初始化库后，会在当前目录生成`.git`文件，但直接通过`ls`命令则无法查看，需要使用加参数`ls -a`来查看全部文件(包括隐藏文件)。
    **Warning!** 
      1. `.git`文件存放了Git仓库内的所有数据。可以用`cd .git`和`ls -altr`来组合查看。
      2. 通常不要去破坏`.git`文件，因为它是仓库关键的配置文件，破坏它们会破坏Git仓库。而如果把`.git`文件删掉(`\rm -rf .git`)则整个仓库都会被删除。  
   
      我们可以直接在文件夹里创建我们想要的仓库，用`git init 仓库名`的语法即可。这同样会在新建成的库内生成`.git`文件,并且分支判断会回到`main`分支(即主干)。

   2. *clone* 
      `clone`是一种用于克隆(复制)他人或者远程Git仓库到本地的命令。它将仓库拷贝到本地，使开发者能够查看后修改该项目，并同步了仓库的所有代码和历史记录，也在本地创建了一个一模一样的副本。  
      它的格式是`git clone [url]`,`url`是远程仓库的链接地址。这会在本地创建一个同名的一模一样文件夹。文件夹内是复制的库，包含全部的分支和历史记录。你可以使用其他的Git命令(如 `git checkout`、`git pull`)对本地仓库进行操作。 
      1. `cd ..`可以返回上一级文件夹或者退出库
      2. `ls -ltr`或者`ls -str`可以查看文件夹内可见文件，`ls -atr`可以查看文件夹内所有文件。
6. `git status`
   \* **查看当前所在的分支和分支内的文件情况**。若写作`git status -s`表示查看状态这个命令的省略模式（它的返回会有`??`，第一列表示暂存区的状态，第二列表示工作区的状态）。
7. 在当前库的文件夹下，`echo"文字内容"`+`文件名.文件格式`可以用于创建一个文本文件，之后可以用`ls`打开并**用`cat 文件名.文件格式`的方式查看文件内容**
8. `ls`可以直接查看工作区存在的文件，`git ls-files`指令查看暂存区存在的文件；`cat`命令可以查看文件的具体内容
   ![g2](/jpg/g2.png)
9.  **暂存与删除** 
   1. `git add`   
   使文件添加到暂存区(被跟踪)
   2. `git add .`    
   将所有文件都添加到暂存区
   3. `git reset`    
   使文件退出暂存进入工作区
   4. `git rm`
   删除工作区文件并将这次删除放入暂存区
   5. `git rm -f`    
   删除工作区和暂存区文件并将这次删除存入暂存区(防止报错)
   6. `git rm --cached`
   删除暂存区文件，保留工作区文件并将这次删除写入暂存区
   7. `rm+文件名`     
   删除工作区的文件     
10. `git commit -m`      
    提交暂存区的文件到仓库中，是文件真正保存起来
    > 若没有`-m`这个默认标志,则会进入一个交互界面(通常是`vim`)手动设置信息存入,非常麻烦   
    > **`vim`是一种非常强大的文本编辑器.用方向键来使光标移动,按`i`进入编辑模式,可以在指定的地方输入编辑信息,按`Esc`回到命令模式,输入`:wq`保存退出就完成了**
11. `git commit -am 文件名`    
    同时完成添加至暂存区和提交至仓库两个操作
12. `git diff`    
    用于查看文件在工作区、暂存区以及版本库之间的差异     
    它的输出分为5个部分：
    变更文件名、被`哈希算法`转换为40位的哈希值的文件内容(可能只显示前几位，最后的几位数字代表`文件的权限`)、修改的内容(**红色原来绿色现在**)。若没有内容代表工作区和暂存区的内容一致。
    > `git diff HEAD`可以比较版本库和工作区之间的差异，`HEAD`指向分支的**最新提交结点**，可以拿不同次提交的哈希ID来和`HEAD`比较。`Git`还允许用`HEAD~n`或者`HEAD^n`来表示当前的上$n$个结点的ID。
    > `git diff --cached`可以查看暂存区和版本库之间的差异
13. `vi 文件名`      
    用于打开`vim`界面修改文件信息，具体操作同上.
14. `git reset`      
    > +`--soft`:使分支回退到之前的一个版本，但是保留工作区和暂存区的所有修改内容

    > +`--hard`:使分支回退到之前的一个版本且放弃工作区和暂存区的所有修改内容，可尾随`HARD^`来特指上一个版本

    > +`--mixed`:介于前两者之间，回退到之前的某个版本但是只保留工作区的修改内容(**默认参数**)
    ![g1](/jpg/g1.png)
15. `git log`(--`online`\ `local`)：**查看提交历史**
16. `echo "文本信息" > 文件名`   
    可以临时性创建一个文件或者对文件追加内容.
# 5. ".gitignore"
- 用于使文件夹中的有些文件有选择地不上传到库里而暂存到`.gitignore`中(也就是**忽略**)。**`.gitignore`需要自己创建**
- ![g3](/jpg/g3.png)
- 应该忽略哪些文件？
  1. 系统或者软件自动生成的文件
  2. 编译产生的中间文件和结果文件   
      >  如Java生成的`.class`文件和C语言生成的`.o`文件)
  3.  运行时生成的日志文件、缓存文件、临时文件
  4.  涉及身份、密码、口令、密钥等敏感信息文件.
- `.gitignore`会接收我们提交给`Git`的模式，模式体现的这些文件不会被提交到版本库中去。**`.gitignore`相当于一个临时的回收站**
- 【Bug】:`.gitignore`无法对已经被添加到库中文件发挥作用，只对工作区和暂存区的内容有效。
- **若库所在的文件夹中有空文件夹，那么该文件夹将不会被纳入`git`的版本控制中**。当然可以用`mkdir 文件夹名`来创建新的文件夹
- 若要只在库内删除应屏蔽的文件，可以用`git rm --cached 文件名`。用`git rm 文件名`会把库、本地的文件全删除.
- **具体步骤**：      
  > 1. 若要在库\分支中屏蔽相关文件，可以将文件名添加到`.gitignore`中，这会使库中对应文件名的文件被忽略。
  > 2. 若要一次性屏蔽所有的相关文件(如哪类文件.xxx)，可以使用**通配符**来匹配所有以后缀结尾的文件,如`*.log`等。
  > 3. 若要一次性屏蔽一个文件夹，可以用`文件夹名\`的格式

___
- `.gitignore`文件的匹配规则
  - 它是**从上到下逐行匹配**，每一行代表一个忽略模式(rule pattern)
- 常用的一些格式
  > 1. 空格或者`#`开头的行会被`Git`忽略。一般**空格用于可读性的分割，#用于注释信息**
  > 2. 使用标准的`glob`模式(`shell`所使用的简化了的正则表达式)进行匹配，例如：      
  >    1. `*`代表通配任意个字符
  >    2. `?`代表通配单个字符
  >    3. `[···]`表示匹配列表中含有的单个字符，如:[abc]代表a/b/c
  >    4. `[]`中间可以用短中线`-`连接，代表两端所框定的全部成员都选中。如[a-z]表示全部小写字母
  >    5. `**`代表匹配任意的中间目录
  >    6. `！`表示取反，要忽略指定模式以外的文件或者目录
- 详细规则见于`Git`官网的[相关网址](https://git-scm.com/docs/gitignore)
- 例如： 
  ![g4](/jpg/g4.png)
  ![g5](/jpg/g5.png)
# 6.如何使用Github来管理我们的代码
   - 将本地仓库和Github关联起来
      ![g6](/jpg/g6.png)
   - 远程仓库地址的两种方式：`HTTPS`和`SSH`。
      1. HTTPS
         > 在本地代码`push`到远程仓库的时候需要验证用户名和密码(官方已放弃)
         > 地址格式：`https://github.com/····/xxx.git`
      2. SSH
         > 不用验证用户名和密码，但要在Github上添加对应地址的`SSH公钥`的配置
         > **使用SSH方式必须要配置SSH密钥。**

         > 给Github配置SSH密钥：    
         >  1. 打开到库文件夹的根目录
         >  2. `cd .shh`
         >  3. `ssh-keygen -t 协议方式 -b 指定生成大小`  %例如`rsa`协议方式和`4096`大小
         >  4. 进入下一步设置密钥名称。若是第一次访问，则可以用**回车**跳过，系统将自动在`.shh`目录下生成`id_rsa`的密钥文件；    
         > 若已经生成过`shh`密钥，**千万不要回车**，因为它会覆盖掉原来的`shh`密钥信息且不可逆。对此我们应该输入设置一个新的文件名和密码。此时库中会生成`文件名`和`文件名.pub`两个文件。其中`文件名`文件是生成的私钥，`文件名.pub`文件是生成的公钥。
         >  5. 复制`文件名.pub`中的公钥文件，到个人账号的`Settings`中的`SSH and 
         GPG keys`的`New SSH Keys`的选项中添加我们创建的文件名和公钥文件并保存。
         > 6. 若是第一次访问或者没有更改`SHH`密钥文件名，则不用操作；
         > 若更改了文件名，我们需要创建一个`config`文件，语法为`tail -5 config`
         .**在`config`文件内输入以下5行信息：     
         > \# github
         > Host github.com
         > HostName github.com
         > PreferredAuthentications publickey
         > TdentityFile ~/.ssh/文件名**
         > 7. 这样我们就使得本地库和Github之间建立了联系。

         > 地址格式：`git@github.com:····/·xxx.git`
   - 推送与拉取
      - `git push`:推送到远程仓库
      - `git pull`:抓取到本地仓库来
      - `git clone 仓库地址`：从远程仓库复制一个完整的库到本地